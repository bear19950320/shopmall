var testurl="http://www.tblmall.com:85";var loginurl="http://120.76.247.147:85";var dataCount=0;$(document).ready(function(){$("body").css({"width":$(window).width(),"height":$(window).height()});console.log($(window).width()+"---"+$(window).height());isWeiXin();isMax()});function getcookie(name){var strcookie=document.cookie;var arrcookie=strcookie.split("; ");for(var i=0;i<arrcookie.length;i++){var arr=arrcookie[i].split("=");if(arr[0]==name){return decodeURIComponent(arr[1])}}return""}function delCookie(name){var exp=new Date();exp.setTime(exp.getTime()-1);var cval=getcookie(name);if(cval!=null){document.cookie=name+"="+cval+"; path=/;expires="+exp.toGMTString()}}function log(val){console.log(val)}$("#package").height($(this).height());function IsPC(){var userAgentInfo=navigator.userAgent;var Agents=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"];var flag=true;for(var v=0;v<Agents.length;v++){if(userAgentInfo.indexOf(Agents[v])>0){flag=false;break}}if(flag){}else{$("body").css({"width":$(window).width(),"height":$(window).height()})}return flag}function isWeiXin(){var ua=window.navigator.userAgent.toLowerCase();if(ua.match(/MicroMessenger/i)=="micromessenger"){$(".H-head").hide();$(".cart").css("padding-top","1rem");$("body").css({"width":$(window).width(),"height":$(window).height()});return true}else{$(".H-head").show();return false}}function isMax(){if($(window).width()>1024){$("body").css({"width":1024+"px","margin":"auto","border":"1px solid #333"});$(".H-head").css({"width":$("body").width(),"padding":"1rem 0"});$(".specificationsBox").css({"width":$("body").width(),"padding":0,"padding-top":"25px"});$("#Pay,.orderUp").css({"width":$("body").width(),"padding":"0"})}}function loadImg(){$("body").append('<img id="loadImg" src="../img/ajax-loader.gif" width="48" height="48" alt="" style="position: fixed;top:50%;margin-top: -24px;left:50%;margin-left: -24px;"/>')}function homeLoadImg(){$("body").append('<img id="loadImg" src="img/ajax-loader.gif" width="48" height="48" alt="" style="position: fixed;top:50%;margin-top: -24px;left:50%;margin-left: -24px;"/>')
}function removerLoad(){$("body").remove('<img id="loadImg" src="img/ajax-loader.gif" width="48" height="48" alt="" style="position: fixed;top:50%;margin-top: -24px;left:50%;margin-left: -24px;"/>')}function showLogin(){}function classIfyList(thisId){$.ajax({type:"GET",url:testurl+"/api/classify/classifylist",data:{platform:"2",type:1,classifyId:thisId},dataType:"json",xhrFields:{withCredentials:true},crossDomain:true,async:true,success:function(data){var classifyList=data.data.classifyList;if(classifyList.length!=0){$("#classifyListTitle").empty();$("#classifyListTitle").append('<li id="'+thisId+'"><span class="selected">??</span></li>');$("#"+thisId).click(function(){$("#classifyListUl").empty();classIfyList($(this).attr("id"));classIfy($(this).attr("id"),dataCount);$(this).find("span").addClass("selected");$(this).siblings().find("span").removeClass("selected");$("html,body").animate({scrollTop:0},800)});for(var i=0;i<classifyList.length;i++){$("#classifyListTitle").append("<li id="+classifyList[i].id+"><span>"+classifyList[i].text+"</span></li>");$("#"+classifyList[i].id).click(function(){$("#classifyListUl").empty();classIfyList($(this).attr("id"));classIfy($(this).attr("id"),dataCount);$(this).find("span").addClass("selected");$(this).siblings().find("span").removeClass("selected");$("html,body").animate({scrollTop:0},800)})}}}});console.log(thisId)}function classIfy(thisId,dataCount){$.ajax({type:"GET",url:testurl+"/api/classify/classifywarelist",data:{platform:"2",type:1,classifyId:thisId,pageId:dataCount,pageSize:"10"},dataType:"json",xhrFields:{withCredentials:true},crossDomain:true,async:true,timeout:1000,beforeSend:function(XMLHttpRequest){loadImg()},success:function(data){var wareList=data.data.wareList;if(typeof wareList=="object"){var oProduct,$row,iHeight,iTempHeight;for(var i=0,l=wareList.length;i<l;i++){oProduct=wareList[i];iHeight=-1;$("#classifyListUl li").each(function(){iTempHeight=Number($(this).height());if(iHeight==-1||iHeight>iTempHeight){iHeight=iTempHeight;
$row=$(this)}});if(wareList.length!=0){for(var i=0;i<wareList.length;i++){$("#classifyListUl").append("<li id="+wareList[i].wareId+' style="padding: 15px 2%;border-bottom: 1px solid #EAEAEA;">'+"<img src="+wareList[i].image1file+' width="90" height="90" alt="" />'+'<div class="classifyListContent">'+'<p class="classifyListText left support'+wareList[i].support+'"><span style="width:25px;color:#B14CAD;border:1px solid #B14CAD;padding: 3px 6px;margin-right: 6px;">??</span>'+wareList[i].wareName+"</p>"+'<div class="classifyListDetails">'+'<span class="Number" style="position: relative;">?'+wareList[i].warePrice.toFixed(2)+' <span style="position: absolute;right: -5px;top:-2px;color:#DC210D;right:-40px;">+?'+wareList[i].bonusMoney+"</span></span>"+'<div style="display: block;">??: '+wareList[i].sales+"</div>"+'<div class="imgDiv">'+'<img src="../img/share.png" class="share" width="30" height="24" alt="" />'+"</div>"+"</div>"+"</div>"+"</li>");var wid=$("#classifyListUl>li").width()-$("#classifyListUl>li>img").width();var wids=$("#classifyListUl>li").width()-$("#classifyListUl>li>img").width()-15;var widc=wid-15;$("#classifyListUl li").eq(i).find(".Number").find("span").css("right",-(Number($("#classifyListUl li").eq(i).find(".Number").find("span").width())+5)+"px");$("#classifyListUl>li>div").css({"width":widc,"height":$("#classifyListUl>li>img").height(),"padding-left":"12px"});$("#"+wareList[i].wareId).click(function(event){event.stopPropagation();sessionStorage.setItem("TowareId","");var TowareId=$(this).attr("id");sessionStorage.setItem("TowareId",TowareId);window.location.href="./detailsdemo.html"});$(".share").click(function(event){event.stopPropagation();share($(this).parents("li").attr("id"),$(this).parents("li").find("img").attr("src"),$(this).parents(".classifyListContent").find(".classifyListText").text());$(".laye").show()})}dataCount++}}}},complete:function(XMLHttpRequest,textStatus){$("#loadImg").remove()},error:function(data){if(data.status=="404"){alert("???????")
}else{if(data.status=="302"){alert("??????")}else{if(data.status=="timeout"){alert("????!")}else{alert("??????~?")}}}}});return dataCount}function outlogin(){$.ajax({type:"POST",data:{platform:"2",cutomerId:localStorage.getItem("cutomerId")},url:testurl+"/api/login/outlogin",dataType:"json",xhrFields:{withCredentials:true},crossDomain:true,success:function(data){if(data.code==10000){localStorage.setItem("cutomerId"," ");localStorage.setItem("loginStatus"," ");location.href="./login.html"}}})}function mask(te,fun){$("body").append('<div id="mask" style="width:100%;height:100%;position: fixed;top:0;left:0;background: rgba(0,0,0,.2);z-index:999;">'+'<div style="width: 50%;height:120px;background: #D2D2D2;position: absolute;top:50%;margin-top:-60px;left:25%;border-radius: 5px;">'+'<div style="width:99%;height: 99%;position:absolute;top:0.7%;left:0.5%;background: #fff;border-radius: 5px;text-align: center;">'+'<div style="padding: 5%;width:90%;height:90%;">'+"<h4>????</h4>"+"<br />"+"<hr />"+"<br />"+"<p>"+te+"</p>"+"</div>"+"</div>"+"</div>"+"</div>");$("#mask").click(function(){$(this).remove()})}function addresslist(){$(document).ready(function(e){var lines=$(".line-normal-wrapper1");var len=lines.length;var lastX,lastXForMobile;var pressedObj;var lastLeftObj;var start;for(var i=0;i<len;++i){lines[i].addEventListener("touchstart",function(e){lastXForMobile=e.changedTouches[0].pageX;pressedObj=this;var touches=event.touches[0];start={x:touches.pageX,y:touches.pageY}});lines[i].addEventListener("touchmove",function(e){var touches=event.touches[0];delta={x:touches.pageX-start.x,y:touches.pageY-start.y};if(Math.abs(delta.x)>Math.abs(delta.y)){event.preventDefault()}});lines[i].addEventListener("touchend",function(e){if(lastLeftObj&&pressedObj!=lastLeftObj){$(lastLeftObj).animate({marginLeft:"0"},500);lastLeftObj=null}var diffX=e.changedTouches[0].pageX-lastXForMobile;if(diffX<-150){$(".delBtn button").height($(".line-scroll-wrapper1").height());$(pressedObj).animate({marginLeft:"-132px"},500);
lastLeftObj&&lastLeftObj!=pressedObj&&$(lastLeftObj).animate({marginLeft:"0"},500);lastLeftObj=pressedObj}else{if(diffX>150){if(pressedObj==lastLeftObj){$(pressedObj).animate({marginLeft:"0"},500);lastLeftObj=null}}}})}for(var i=0;i<len;++i){$(lines[i]).bind("mousedown",function(e){lastX=e.clientX;pressedObj=this});$(lines[i]).bind("mouseup",function(e){if(lastLeftObj&&pressedObj!=lastLeftObj){$(lastLeftObj).animate({marginLeft:"0"},500);lastLeftObj=null}var diffX=e.clientX-lastX;if(diffX<-150){$(pressedObj).animate({marginLeft:"-132px"},500);lastLeftObj&&lastLeftObj!=pressedObj&&$(lastLeftObj).animate({marginLeft:"0"},500);lastLeftObj=pressedObj}else{if(diffX>150){if(pressedObj==lastLeftObj){$(pressedObj).animate({marginLeft:"0"},500);lastLeftObj=null}}}})}})}function updateshopcart(){var n="";for(i=0;i<$(".line-wrapper .line-scroll-wrapper").length;i++){n+=$(".line-wrapper .line-scroll-wrapper .delBtn").eq(i).find("button").attr("id")+",";n+=$(".line-wrapper .line-normal-wrapper").eq(i).find(".number").val()+";"}n=n.substr(0,n.length-1);$.ajax({type:"POST",data:{platform:"2",cutomerId:localStorage.getItem("cutomerId"),shopcartContent:n},url:testurl+"/api/shopcart/updateshopcart",dataType:"json",xhrFields:{withCredentials:true},crossDomain:true,success:function(data){},error:function(){}})}function shopNum(){function IsPC(){var userAgentInfo=navigator.userAgent;var Agents=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"];var flag=true;for(var v=0;v<Agents.length;v++){if(userAgentInfo.indexOf(Agents[v])>0){flag=false;break}}if(flag){$(".line-normal-wrapper").width($(".line-wrapper").width());$(".line-scroll-wrapper").width($(".line-wrapper").width()+$(".line-btn-delete").width());$(".cart dd").css("padding","1rem 0");$(".delBtn button").height($(".line-wrapper").height())}else{$("body").css({"width":$(window).width(),"height":$(window).height()});$(".line-scroll-wrapper").width($(".line-wrapper").width()+$(".line-btn-delete").width());$(".line-normal-wrapper").width($(".line-wrapper").width());
$(".line-normal-msg").width($(".line-normal-wrapper").width()-280)}return flag}$(document).ready(function(e){if($(window).width()>1024){$("body").css({"width":1024+"px","margin":"auto","border":"1px solid #333"});$(".H-head").css({"width":$("body").width(),"padding":"1rem 0"})}IsPC();var lines=$(".line-normal-wrapper");var len=lines.length;var lastX,lastXForMobile;var pressedObj;var lastLeftObj;var start;for(var i=0;i<len;++i){lines[i].addEventListener("touchstart",function(e){lastXForMobile=e.changedTouches[0].pageX;pressedObj=this;var touches=event.touches[0];start={x:touches.pageX,y:touches.pageY}});lines[i].addEventListener("touchmove",function(e){var touches=event.touches[0];delta={x:touches.pageX-start.x,y:touches.pageY-start.y};if(Math.abs(delta.x)>Math.abs(delta.y)){event.preventDefault()}});lines[i].addEventListener("touchend",function(e){if(lastLeftObj&&pressedObj!=lastLeftObj){$(lastLeftObj).animate({marginLeft:"0"},500);lastLeftObj=null}var diffX=e.changedTouches[0].pageX-lastXForMobile;if(diffX<-150){$(".delBtn button").height($(".line-scroll-wrapper").height());$(pressedObj).animate({marginLeft:"-132px"},500);lastLeftObj&&lastLeftObj!=pressedObj&&$(lastLeftObj).animate({marginLeft:"0"},500);lastLeftObj=pressedObj}else{if(diffX>150){if(pressedObj==lastLeftObj){$(pressedObj).animate({marginLeft:"0"},500);lastLeftObj=null}}}})}for(var i=0;i<len;++i){$(lines[i]).bind("mousedown",function(e){lastX=e.clientX;pressedObj=this});$(lines[i]).bind("mouseup",function(e){if(lastLeftObj&&pressedObj!=lastLeftObj){$(lastLeftObj).animate({marginLeft:"0"},500);lastLeftObj=null}var diffX=e.clientX-lastX;if(diffX<-150){$(pressedObj).animate({marginLeft:"-132px"},500);lastLeftObj&&lastLeftObj!=pressedObj&&$(lastLeftObj).animate({marginLeft:"0"},500);lastLeftObj=pressedObj}else{if(diffX>150){if(pressedObj==lastLeftObj){$(pressedObj).animate({marginLeft:"0"},500);lastLeftObj=null}}}})}shopCart();$(".edit").toggle(function(){$(this).parent().siblings("dd").find(".delBtn").fadeIn();
$(this).html("??")},function(){$(this).parent().siblings("dd").find(".delBtn").fadeOut();$(this).html("??")});$(".minus").click(function(){var currNum=$(this).siblings("span").find(".number");if(currNum.val()<=1){currNum.val("1")}else{currNum.val(parseInt(currNum.val())-1);$(this).parent().find(".num").html(currNum.val())}var num=0;for(var i=0;i<$('.cart dd>input[type="checkbox"]:checked').length;i++){num+=Number($('.cart dd>input[type="checkbox"]:checked').eq(i).siblings(".goodsInfor").find(".number").val())}$(".total").text(num);shopCart()});$(".cloudPlus").click(function(){if($(this).siblings("span").find(".number").val()<$(this).siblings("span").find(".number").attr("name")){var currNum=$(this).siblings("span").find(".number");currNum.val(parseInt(currNum.val())+1);$(this).parent().find(".number").html(currNum.val())}else{if($(this).siblings("span").find(".number").val()>$(this).siblings("span").find(".number").attr("name")){$(this).siblings("span").find(".number").val($(this).siblings("span").find(".number").attr("name"))}}shopCart();var num=0;for(var i=0;i<$('.cart dd>input[type="checkbox"]:checked').length;i++){num+=Number($('.cart dd>input[type="checkbox"]:checked').eq(i).siblings(".goodsInfor").find(".number").val())}$(".total").text(num)});$(".plus").click(function(){var currNum=$(this).siblings("span").find(".number");currNum.val(parseInt(currNum.val())+1);$(this).parent().find(".num").html(currNum.val());shopCart()});$(".delBtn").click(function(){shopCart();nullTips()});function nullTips(){if($(".cart dd").length==0){var tipsCont="<mark style='display:block;background:none;text-align:center;color:grey;'>??????</mark>";$(".cart").remove();$("body").append(tipsCont)}}function shopCart(){var sum=money=0;$(".cart dd input").each(function(){if($(this).prop("checked")){var par=Number($(this).siblings(".goodsInfor").find("strong").html());var pra=Number($(this).siblings(".goodsInfor").find(".number").val());money=par*pra;sum+=money}});sum=sum.toFixed(2);$(".money").html(sum)
}$('input[id="all"]').on("change",function(){var num=0;if($(this).prop("checked")){$(".cart dd").parent(".line-scroll-wrapper").siblings(".supplierTitle").find("input").prop("checked",true);$(".cart dd>input").prop("checked",true);$(".cart dd>input").css("background","red");for(var i=0;i<$(".cart dd>input").length;i++){num+=Number($(".cart dd>input").eq(i).siblings(".goodsInfor").find(".number").val())}}else{$(".cart dd").parent(".line-scroll-wrapper").siblings(".supplierTitle").find("input").prop("checked",false);$(".cart dd>input").prop("checked",false);$(".cart dd>input").css("background","none")}$(".total").text(num);shopCart()});$('.cart dd input[class="checkbox"]').on("change",function(){if($(this).parents(".line-wrapper").find('input[class="checkbox"]:checked').length<$(this).parents(".line-wrapper").find(".line-scroll-wrapper").length){$(this).parents(".line-wrapper").find(".supplierTitle").find("input").prop("checked",false)}else{$(this).parents(".line-wrapper").find(".supplierTitle").find("input").prop("checked",true)}if($('.cart dd input[class="checkbox"]:checked').length<$('.cart dd input[type="checkbox"]').length){$('input[id="all"]').prop("checked",false);$(".cart dd>input").css("background","none")}else{$('input[id="all"]').prop("checked",true);$(".cart dd>input").css("background","red")}if($('.cart dd input[type="checkbox"]:checked').length==0){$(".total").text($('.cart dd input[type="checkbox"]:checked').length)}else{$(".total").text($('.cart dd input[type="checkbox"]:checked').length)}var num=0;for(var i=0;i<$('.cart dd>input[type="checkbox"]:checked').length;i++){num+=Number($('.cart dd>input[type="checkbox"]:checked').eq(i).siblings(".goodsInfor").find(".number").val())}$(".total").text(num);shopCart()});$(".enter").click(function(){if($('dd input[type="checkbox"]').length!=0&&$('.cart dd input[type="checkbox"]:checked').length!=0){window.location="confirm_order.html"}})})}$("body").on("click",'input[type="checkbox"]',function(){$(this).show();if($(this).prop("checked")){$(this).css({"display":"inline-block","background":"url(../img/icon/My_Selected@2x.png)"});
console.log($(this).attr("style"))}});function imgNot(){$("img").error(function(){$(this).attr("src","../img/imgNoload.png")})}imgNot();
